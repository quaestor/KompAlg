\section*{Aufgabe 16 - Devil's Staircase}
\addcontentsline{toc}{subsection}{Aufgabe 16 - Devil's Staircase}
\begin{enumerate}
% teil 1: automaten interpretation, Ak für k = 2,3,4
\item
	\begin{itemize}
		\item $k= 2$: 
			\[ A2 = \begin{bmatrix}
					1 & 1 \\
					2 & 0 \\
				\end{bmatrix} \]
			\[ \chi_2(z) = \det \left( 
				\begin{bmatrix}
					z - 1 & -1 \\
					-z    & z  \\
				\end{bmatrix} \right) =
				z^2 - z - 2 = (z-2)(z+1) \]
			Die Eigenwerte sind $\lambda_1 = 2$ und $\lambda_2 = -1$.
		\item $k = 3$:
			\[ A3 = \begin{bmatrix}
					1 & 1 & 0 \\
					1 & 0 & 1 \\
					2 & 0 & 0 \\
				\end{bmatrix} \]
			\[ \chi_3(z) = \det \left(
				\begin{bmatrix}
					z-1 & -1 & 0 \\
					-1 & z & -1 \\
					-2 & 0 & z \\
				\end{bmatrix} \right) =
				z^3 - z^2 - z - 2 = (z-2)(z^2 + z + 1) \]
			Die Eigenwerte sind $\lambda_1 = 2, \lambda_2 = \omega_3, \lambda_3 = \omega_3^2 $,
			wobei $\omega_3$ die dritte Einheitswurzel $e^{\imath 2 \pi / 3}$ ist.
		\item $k = 4$:
			\[ A4 =	\begin{bmatrix}
					1 & 1 & 0 & 0 \\
					1 & 0 & 1 & 0 \\
					1 & 0 & 0 & 1 \\
					2 & 0 & 0 & 0 \\
				\end{bmatrix} \]
			\[ \chi_4(z) = \det \left(
				\begin{bmatrix}
					z-1 & -1 & 0 & 0 \\
					-1 & z & -1 & 0 \\
					-1 & 0 & z & -1 \\
					-2 & 0 & 0 & z \\
				\end{bmatrix} \right) = 
				(z-1) z^3 + \det \left(
					\begin{bmatrix}
						-1 & -1 & 0 \\
						-1 & z & -1 \\
						-2 & 0 & z \\
					\end{bmatrix} \right) = \] \[
				(z-1)z^3 - z^2 - z  - 2 =
				z^4 - z^3 - z^2 - z - 2 =
				(z-2)(z^3 + z^2 + z + 1) \]
			Die Eigenwerte sind $\lambda_1 = 2, \lambda_2 = \omega_4, \lambda_3 = \omega_4^2, \lambda_4 = \omega_4^3$,
			wobei $\omega_4$ die vierte Einheitswurzel $e^{\imath 2 \pi / 4} = \imath$ ist.
	\end{itemize}

% teil 2: allgemeine Ak
\item Allgemein sieht die Matrix $Ak$ folgendermaßen aus:
	\[ Ak = \begin{bmatrix}
			1      & 1      & 0      & \cdots & \cdots & \cdots & 0      \\
			1      & 0      & 1      & 0      &        &        & \vdots \\
			\vdots & \vdots & \ddots & \ddots & \ddots &        & \vdots \\
			\vdots & \vdots &        & \ddots & \ddots & \ddots & \vdots \\
			\vdots & \vdots &        &        & \ddots & \ddots & 0      \\
			1      & \vdots &        &        &        & \ddots & 1      \\
			2      & 0      & \cdots & \cdots & \cdots & \cdots & 0      \\
		\end{bmatrix} \]
	Das Charakteristische Polynom lässt sich rekursiv berechnen (Entwicklung nach erster Zeile,
	nachdem 2. Spalte auf 1. Spalte addiert wurde):
	\begin{eqnarray*}
		\chi_k(z) &=& \det \left(
				\begin{bmatrix}
					z-1    & -1     & 0      & \cdots & \cdots & \cdots & 0      \\
					-1     & z      & -1     & 0      &        &        & \vdots \\
					\vdots & 0      & \ddots & \ddots & \ddots &        & \vdots \\
					\vdots & \vdots &        & \ddots & \ddots & \ddots & \vdots \\
					\vdots & \vdots &        &        & \ddots & \ddots & 0      \\
					-1     & \vdots &        &        &        & \ddots & -1     \\
					-2     & 0      & \cdots & \cdots & \cdots & \cdots & z      \\
				\end{bmatrix} \right) = \\
			&=& \det \left(
				\begin{bmatrix}
					z-2    & -1     & 0      & \cdots & \cdots & \cdots & 0      \\
					z-1    & z      & -1     & 0      &        &        & \vdots \\
					\vdots & 0      & \ddots & \ddots & \ddots &        & \vdots \\
					\vdots & \vdots &        & \ddots & \ddots & \ddots & \vdots \\
					\vdots & \vdots &        &        & \ddots & \ddots & 0      \\
					-1     & \vdots &        &        &        & \ddots & -1     \\
					-2     & 0      & \cdots & \cdots & \cdots & \cdots & z      \\
				\end{bmatrix} \right) = \\
			&=& (z-2) \det \left(
				\begin{bmatrix}
					& z      & -1     & 0      &        &        & \vdots \\
                                        & 0      & \ddots & \ddots & \ddots &        & \vdots \\
                                        & \vdots &        & \ddots & \ddots & \ddots & \vdots \\
                                        & \vdots &        &        & \ddots & \ddots & 0      \\
                                        & \vdots &        &        &        & \ddots & -1     \\
                                        & 0      & \cdots & \cdots & \cdots & \cdots & z      \\
				\end{bmatrix} \right) + \\
				& & \quad \quad \quad
				\det \left(
				\begin{bmatrix}
					z-1    & -1     & 0      & \cdots & \cdots & 0      \\
					-1     & z      & -1     & 0      &        & \vdots \\
					\vdots & 0      & \ddots & \ddots & \ddots & \vdots \\
					\vdots & \vdots &        & \ddots & \ddots & 0      \\
					-1     & \vdots &        &        & \ddots & -1     \\
					-2     & 0      & \cdots & \cdots & \cdots & z      \\
				\end{bmatrix} \right) = \\
			&=& (z-2) z^{k-1} + \chi_{k-1}(z)
	\end{eqnarray*}
	Mit Hilfe dieses Zusammenhangs kann man per vollständiger Induktion die gewünschte Formel beweisen:
	\begin{itemize}
		\item \textit{I.A.}: $k=2$: \[ \chi_2(z) = (z-2)(z+1) = (z-2)\frac{(z+1)(z-1)}{z-1} = (z-2)\frac{z^2 - 1}{z-1} \]
		\item \textit{I.V.}: Für ein $k \in \mathbb{N}$ gelte:
			\[ \chi_k(z) = (z-2)\frac{z^k - 1}{z-1} \]
		\item \textit{I.S.}: $k \rightarrow k+1$:
			\begin{eqnarray*}
			\chi_{k+1}(z) &=& (z-2) z^{k} + \chi_k(z) \overset{I.V.}{=} (z-2) z^k + (z-2) \frac{z^k - 1}{z-1} \\
			   &=& (z-2) \frac{z^k (z-1)}{z-1} + (z-2)\frac{z^k - 1}{z-1} =
			   (z-2) \frac{z^{k+1} - 1}{z-1}
			\end{eqnarray*}
	\end{itemize}
	Die Eigenwerte sind zum einen $\lambda_1 = 2$ und zum anderen die Lösungen von $z^k - 1 = 0$ (außer $z = 1$), also den
	$k$-ten Einheitswurzeln, $\lambda_i = e^{\imath 2 \pi \frac{j}{k}}$ mit $1 \leq j \leq k-1$, sie liegen
	auf einem Kreis mit Radius $1$ um den Ursprung.

\item 


\item
  $A_{k,p}$ für $k = 2, 3, 4$:

  \begin{minipage}{0.4\linewidth}
  \[ A_{2,p} = \begin{bmatrix} 1-p & p \\ 1 & 0 \end{bmatrix} \]
  \[ \chi_{2,p}(z) = \begin{vmatrix} 1-p-z & p \\ 1 & -z \end{vmatrix} \]
  \[ = z^{2} + pz - z - p \]
  \[ \lambda_{1} = 1, \quad \lambda_{2}= -p \] \\[0.5em]
  \[ A_{3,p} = \begin{bmatrix} 1-p & p & 0 \\
                               1-p & 0 & p \\
                                 1 & 0 & 0 \end{bmatrix} \]
  \[ \chi_{3,p}(z) = \begin{vmatrix} 1-p-z & p  & 0 \\
                                       1-p   & -z & p \\
                                       1     & 0  & -z \end{vmatrix} \]
  \[ = -z^{3} - pz^{2} + z^{2} - p^{2}z + pz + p^{2} = \]
  \[ = -(z - 1) (z^{2} + pz + p^{2}) \]
  \[ \lambda_{1}= 1 \]
  \[ \lambda_{2}= -\frac{p}{2}(1 - i\sqrt{3}), \quad
     \lambda_{3}= -\frac{p}{2}(1 + i\sqrt{3}) \]
  \end{minipage}\hfill\begin{minipage}{0.5\linewidth}
  \[ A_{4,p} = \begin{bmatrix} 1-p & p & 0 & 0 \\
                               1-p & 0 & p & 0 \\
                               1-p & 0 & 0 & p \\
                                 1 & 0 & 0 & 0 \end{bmatrix} \]
  \[ \chi_{4,p}(z) = det(A_{4,p} - z\cdot \mathds{1}) = \]
  \[                 -\begin{vmatrix} p & 0 & 0 \\
                                     -z & p & 0 \\
                                      0 &-z & p \end{vmatrix} 
                     -\begin{vmatrix} 1-p-z & p & 0 \\
                                      1-p & -z & p \\
                                      1-p & 0 & -z \end{vmatrix} \]
  \[ = z^4 + pz^3 - z^3 + p^{2}z^2 - pz^2 + p^{3}z - p^{2}z -p^3 \]
  \[ = (z - 1) (z^{3} + pz^{2} + p^{2}z + p^{3}) \]
  \[ \lambda_{1}= 1, \]
  \[ \lambda_{2}= -p, \quad
     \lambda_{3}= ip, \quad
     \lambda_{4}= -ip\]
  \end{minipage}
  
\item
  \[ A_{k,p} = \left[a_{ij}\right]_{1\leq i,j\leq k}, \]
  \[ a_{ij} = \begin{cases} 1-p &\text{wenn~} j = 0, i \not= k \\
                              1 &\text{wenn~} j = 0, i = k \\
                              p &\text{wenn~} j = i + 1 \\
                              0 &\text{sonst} \end{cases} \]

  zu zeigen: \[ \chi_{k,p}(z) = (z - 1) \frac{z^{k}-p^{k}}{z-p}(-1)^{k} \]
  Beweis durch Induktion über $k$.
  \begin{itemize}
    \item Induktionsanfang: $k = 2$
      \[ \chi_{z,p}(z) = (z - 1) \frac{z^{2}-p^{2}}{z-p} = (z-1)(z+p) \]
    \item Induktionsvoraussetzung: Die Behauptung gelte für $k$.
    \item Induktionsschritt: $k \rightarrow k + 1$
    
      Sei $B_{k} = \left[b_{ij}\right]_{1\leq i,j\leq k},$
      \[ b_{ij} = \begin{cases} 1-p &\text{wenn~} j = 0, i = k \\
                                0 &\text{sonst} \end{cases} \]
      \begin{tikzpicture}[every node/.style={anchor=west},decoration=brace]
      \matrix (m) [matrix of math nodes,nodes in empty cells] {
      \chi_{B_{k}}(z) &= \begin{vmatrix}
                            1-p-z & p  & 0  & \cdots & 0 \\
                            1-p & -z & p  & \ddots & \vdots \\
                            \vdots & 0  & \ddots & \ddots & 0 \\
                            \vdots & \vdots  & \ddots & \ddots & p \\
                            1-p & 0 & \cdots & 0 & -z
                           \end{vmatrix} = \\
                        &= \begin{vmatrix}
                            1-p-z & p  & 0  & \cdots & 0 \\
                            1-p & -z & p  & \ddots & \vdots \\
                            \vdots & 0  & \ddots & \ddots & 0 \\
                            1-p & \vdots  & \ddots & \ddots & p \\
                            1 & 0 & \cdots & 0 & -z
                           \end{vmatrix} + \begin{vmatrix}
                            1-p-z & p  & 0  & \cdots & 0 \\
                            1-p & -z & p  & \ddots & \vdots \\
                            \vdots & 0  & \ddots & \ddots & 0 \\
                            1-p & \vdots  & \ddots & -z & p \\
                            -p & 0 & \cdots & 0 & 0
                           \end{vmatrix} = \\};
        \begin{scope}[draw=black!70,color=black!70]
        \node[below delimiter=\{,minimum height=0pt,minimum width=3.6cm,text
            width=3.5cm] at (10.85, 1.5) {bidiagonale Unterdeterminante mit dem
            Wert $\prod_{i=1}^{k-1} a_{ii}$, wobei $a_{ii}$ die
            Diagonalelemente sind};
        \end{scope};
        \draw[fill=blue,opacity=0.2] (10.8, -2.52) rectangle (14.53, -0.1);
      \end{tikzpicture}
      \[ \chi_{A_{k}}(z) + (-1)^{k+1}(-p)(p^{k-1})
         = \chi_{A_{k}}(z) + (-1)^{k}p^{k} \]

      \begin{equation*}
        \begin{split}
          \chi_{A_{k+1}}(z) &= -z \chi_{B_{k}}(z) - (-1)^{k+1}p^{k} = \\
          &= -z(\chi_{A_{k}}(z) + (-1)^{k}p^{k}) - (-1)^{k+1}p^{k} = \\
          &= -z \chi_{A_{k}}(z) + (-1)^{k+1}zp^{k} - (-1)^{k+1}p^{k} = \\
          &= -z \chi_{A_{k}}(z) + (-1)^{k+1}p^{k} (z - 1) = \\
          &\overset{IV}{=} -z ((-1)^{k}(z - 1)\frac{z^{k}-p^{k}}{z-p}) +
          (-1)^{k+1}p^{k}(z-1) = \\
          &= (-1)^{k+1} (z-1) (z \frac{z^{k}-p^{k}}{z-p} + p^{k}) \\
          &= (-1)^{k+1} (z-1) \frac{z^{k+1}-zp^{k}+zp^{k}-p^{k+1}}{z-p} = \\
          &= (-1)^{k+1} (z-1) \frac{z^{k+1}-p^{k+1}}{z-p} 
        \end{split}
      \end{equation*}
      Damit ist die Behauptung bewiesen, da das Vorzeichen des
      charakteristischen Polynoms keine Rolle spielt.

      Alternative Lösung (Addition der zweiten auf die erste Spalte):
      \[ \chi_{A_{k}}(z) = \begin{vmatrix}
                            1-p-z & p  & 0  & \cdots & \cdots & 0 \\
                            1-p & -z & p  & \ddots & \ddots & \vdots \\
                            \vdots & 0  & \ddots & \ddots & \ddots & \vdots \\
                            \vdots & \vdots  & \ddots & \ddots & \ddots & 0 \\
                            1-p & \vdots  & \ddots & \ddots & \ddots & p \\
                            1 & 0 & \cdots & \cdots & 0 & -z
                           \end{vmatrix}
                        = \begin{vmatrix}
                            1-z & p  & 0  & \cdots & \cdots & 0 \\
                            1-p-z & -z & p  & \ddots & \ddots &\vdots \\
                            1-p & 0  & \ddots & \ddots & \ddots & \vdots \\
                            \vdots & \vdots  & \ddots & \ddots & \ddots & 0 \\
                            1-p & \vdots  & \ddots & \ddots & \ddots & p \\
                            1 & 0 & \cdots & \cdots & 0 & -z
                           \end{vmatrix} = \]
      \[ = -(z - 1) (-z)^{k-1} - p\chi_{A_{k-1}}(z-1) = \]
      \[ = (-1)^{k}(z - 1) z^{k-1} - p(z-1)\frac{z^{k-1}-p^{k-1}}{z-p} = \]
      \[ = (-1)^{k}(z - 1) \left( z^{k-1} + \frac{pz^{k-1}-p^{k}}{z-p} \right) = \]
      \[ = (-1)^{k}(z - 1) \left( \frac{z^{k}-z^{k-1}p}{z-p} +
                          \frac{pz^{k-1}-p^{k}}{z-p} \right) = \]
      \[ = (-1)^{k}(z - 1) \left( \frac{z^{k}-p^{k}}{z-p} \right) \]

      $\chi_{A_{k,p}}$ hat die Nullstellen $1$ und die $k$-ten Wurzeln von
      $p^{k}$, welche in der komplexen Ebene auf einem Kreis mit Radius $p$ um
      den Ursprung liegen.
  \end{itemize}

\item
  Da man die Stufe $S_{l}$ nur auf direktem Weg in $l - 1$ Schritten erreichen
  kann, muss man, um beim $n$-ten Schritt auf Stufe $S_{l}$ zu landen, zuvor
  nach $n - l - 1$ Schritten auf der ersten Stufe gestanden haben.

  Die Wahrscheinlichkeit ergibt sich aus dem Produkt der
  Einzelwahrscheinlichkeiten.

  \item
   \[ \lim_{n\rightarrow\infty} P_{1}^{(n)} = a, \quad
      1 = \sum_{i=1}^{k} a \cdot p^{l-1} = \sum_{i=0}^{k-1} a \cdot p^{l} = a
   \sum_{l=0}^{k-1} p^{l} = a \frac{1-p^{k}}{1-p} \]
  \[ \Rightarrow a = \frac{1-p}{1-p^{k}} \]

  \[ (\pi_{i})_{1\leq l\leq k} = (a\cdot p^{l-1})_{1\leq l\leq k} 
     = (\frac{p^{l-1} - p^{l}}{1-p^{k}})_{1\leq l\leq k} \]
\end{enumerate}
